const orbits = document.querySelectorAll('.orbit');
const earth = document.querySelector('.earth');
const moonOrbit = earth.querySelector('.moon-orbit'); // Only moon around Earth
const SPEED_MULTIPLIER = 4;
let baseRadius = 120;
const spacing = 90;
const startAngles = [0, 45, 90, 135, 180, 225, 270, 315];

// Initialize planet positions
orbits.forEach((orbit, index) => {
  const size = baseRadius + index * spacing;
  orbit.style.width = size + 'px';
  orbit.style.height = size + 'px';
  orbit.style.marginLeft = -(size / 2) + 'px';
  orbit.style.marginTop = -(size / 2) + 'px';

  const planet = orbit.querySelector('.planet');
  planet.dataset.angle = startAngles[index];
});

function animate() {
  // Animate planets around the Sun
  orbits.forEach(orbit => {
    const planet = orbit.querySelector('.planet');
    let angle = parseFloat(planet.dataset.angle);
    const speed = parseFloat(orbit.dataset.speed);
    angle += speed * SPEED_MULTIPLIER;

    planet.style.transform = `
      rotate(${angle}deg)
      translateX(${orbit.offsetWidth / 2}px)
      rotate(${-angle}deg)
    `;
    planet.dataset.angle = angle;
  });

  // Animate moon around Earth in Earth's local coordinates
  if (moonOrbit) {
    let moonAngle = parseFloat(moonOrbit.dataset.angle) || 0;
    const moonSpeed = parseFloat(moonOrbit.dataset.speed);
    moonAngle += moonSpeed * SPEED_MULTIPLIER;

    // Only rotate the moon relative to Earth
    moonOrbit.style.transform = `rotate(${moonAngle}deg) translateX(40px)`; 
    moonOrbit.dataset.angle = moonAngle;

    // Keep label upright
    const moonLabel = moonOrbit.querySelector('.label');
    if (moonLabel) {
      moonLabel.style.transform = `rotate(${-moonAngle}deg)`;
    }
  }

  requestAnimationFrame(animate);
}

animate();
